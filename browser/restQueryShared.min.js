(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var r;if(typeof window!=="undefined"){r=window}else if(typeof global!=="undefined"){r=global}else if(typeof self!=="undefined"){r=self}else{r=this}r.restQueryShared=e()}})(function(){var e,r,t;return function a(e,r,t){function n(o,l){if(!r[o]){if(!e[o]){var s=typeof require=="function"&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var p=r[o]={exports:{}};e[o][0].call(p.exports,function(r){var t=e[o][1][r];return n(t?t:r)},p,p.exports,a,e,r,t)}return r[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<t.length;o++)n(t[o]);return n}({1:[function(e,r,t){"use strict";r.exports={path:e("./path.js")}},{"./path.js":3}],2:[function(e,r,t){"use strict";var a={lowerCaseArray:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],upperCaseArray:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],digitArray:["0","1","2","3","4","5","6","7","8","9"],lowerCaseAndDigitArray:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],collectionRegExp:"^[A-Z][a-zA-Z0-9]*$",methodRegExp:"^[A-Z][A-Z0-9-]*$",propertyRegExp:"^(.[a-zA-Z0-9_-]+)+$",linkPropertyRegExp:"^~[a-zA-Z0-9_-]+(.[a-zA-Z0-9_-]+)*$",idRegExp:"^[0-9a-f]{24}$",rangeRegExp:"^([0-9]+)(?:-([0-9]+))?$",slugIdRegExp:"^[a-z0-9-]{1,72}$",asciiMapCommon:{"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ű":"u","ý":"y","þ":"th","ÿ":"y","ẞ":"ss","œ":"oe","Œ":"OE","“":'"',"”":'"',"‘":"'","’":"'","…":"..."},asciiMapWorldAlpha:{"α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"h","ώ":"w","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"H","Ώ":"W","Ϊ":"I","Ϋ":"Y","ş":"s","Ş":"S","ı":"i","İ":"I","ğ":"g","Ğ":"G","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","Є":"Ye","І":"I","Ї":"Yi","Ґ":"G","є":"ye","і":"i","ї":"yi","ґ":"g","č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"e","Ł":"L","Ń":"N","Ś":"S","Ź":"Z","Ż":"Z","ā":"a","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","ū":"u","Ā":"A","Ē":"E","Ģ":"G","Ī":"i","Ķ":"k","Ļ":"L","Ņ":"N","Ū":"u"},asciiMapSymbolsEn:{"€":" euro","₢":" cruzeiro","₣":" french franc","£":" pound","₤":" lira","₥":" mill","₦":" naira","₧":" peseta","₨":" rupee","₩":" won","₪":" new shequel","₫":" dong","₭":" kip","₮":" tugrik","₯":" drachma","₰":" penny","₱":" peso","₲":" guarani","₳":" austral","₴":" hryvnia","₵":" cedi","¢":" cent","¥":" yen","元":" yuan","円":" yen","﷼":" rial","₠":" ecu","¤":" currency","฿":" baht","\\$":" dollar","©":" (c)","∑":" sum","®":" (r)","†":" +","∂":" d","ƒ":" f","™":" tm","℠":" sm","˚":" o","º":" o","ª":" a","•":" *","∆":" delta","∞":" infinity","♥":" love","&":" and","\\|":" or","<":" less",">":" greater"},asciiMapSymbolsFr:{"€":" euro","₢":" cruzeiro","₣":" franc","£":" livre","₤":" lire","₥":" mill","₦":" naira","₧":" peseta","₨":" rupee","₩":" won","₪":" new shequel","₫":" dong","₭":" kip","₮":" tugrik","₯":" drachma","₰":" penny","₱":" peso","₲":" guarani","₳":" austral","₴":" hryvnia","₵":" cedi","¢":" cent","¥":" yen","元":" yuan","円":" yen","﷼":" rial","₠":" ecu","¤":" monnaie","฿":" baht","\\$":" dollar","©":" (c)","∑":" sum","®":" (r)","†":" +","∂":" d","ƒ":" f","™":" tm","℠":" sm","˚":" o","º":" o","ª":" a","•":" *","∆":" delta","∞":" infini","♥":" aime","&":" et","\\|":" ou","<":" moins",">":" plus"}};r.exports=a},{}],3:[function(e,r,t){"use strict";var a=e("./charmap.js");var n=e("string-kit/lib/camel.js");var i={};r.exports=i;i.parse=function l(e,r){var t,a,n,o,l,s,u;if(Array.isArray(e)){return e}else if(typeof e!=="string"){throw new Error("[restQuery] .parse() 'path' should be a string")}try{l=[];o=e.split("/");for(t=0,n=0,a=o.length;t<a;t++){if(o[t]===""){continue}s=i.parseNode(o[t],r);if(n&&(s.type==="property"||s.type==="linkProperty")&&l[n-1].type==="property"){l[n-1].identifier+="."+s.identifier;l[n-1].type=s.type}else{l[n]=s;n++}}}catch(p){u=new Error("Bad URL: '"+o[t]+"' does not match any node type");u.type="badRequest";throw u}return l};i.parseNode=function s(e,r){var t={node:e},i;if(e.length<1){throw new Error("[restQuery] parseNode() : argument #0 length should be >= 1")}if(e.length>72){throw new Error("[restQuery] parseNode() : argument #0 length should be <= 72")}if(r){switch(e){case"*":t.type="wildcard";t.wildcard="any";return t;case"...":t.type="wildcard";t.wildcard="anySubPath";return t;case"[id]":t.type="wildcard";t.wildcard="anyId";return t;case"[slugId]":t.type="wildcard";t.wildcard="anySlugId";return t;case"[document]":t.type="wildcard";t.wildcard="anyDocument";return t;case"[collection]":t.type="wildcard";t.wildcard="anyCollection";return t}}if(a.upperCaseArray.indexOf(e[0])!==-1){if(e.length===1){t.type="collection";t.identifier=e[0].toLowerCase()+e.slice(1);return t}if(a.lowerCaseArray.indexOf(e[1])!==-1){if(e.match(a.collectionRegExp)){t.type="collection";t.identifier=e[0].toLowerCase()+e.slice(1);return t}throw new Error("[restQuery] parseNode() : argument #0 start with an uppercase and then a lowercase letter but mismatch a collection type")}if(e.match(a.methodRegExp)){t.type="method";t.identifier=n.toCamelCase(e);return t}if(e.match(a.collectionRegExp)){t.type="collection";t.identifier=e[0].toLowerCase()+e.slice(1);return t}throw new Error("[restQuery] parseNode() : argument #0 start with an uppercase but mismatch collection or method type")}if(e.length===24&&e.match(a.idRegExp)){t.type="id";t.identifier=e;return t}if(e[0]==="."&&e.match(a.propertyRegExp)){t.type="property";t.identifier=e.slice(1);return t}if(e[0]==="~"&&e.match(a.linkPropertyRegExp)){t.type="linkProperty";t.identifier=e.slice(1);return t}if(a.digitArray.indexOf(e[0])!==-1&&(i=e.match(a.rangeRegExp))){if(i[2]){t.type="range";t.min=parseInt(i[1],10);t.max=parseInt(i[2],10);return t}t.type="offset";t.identifier=parseInt(e,10);return t}if(a.lowerCaseAndDigitArray.indexOf(e[0])!==-1&&e.match(a.slugIdRegExp)){t.type="slugId";t.identifier=e;return t}throw new Error("[restQuery] parseNode() : argument #0 does not validate")};i.match=function u(e,r){var t,a,n,l=0,s=0,u=0,p,f,c={};try{if(!Array.isArray(e)){e=i.parse(e,true)}if(!Array.isArray(r)){r=i.parse(r)}}catch(d){return false}if(e.length===0){return r.length===0?c:false}for(t=0,a=e.length;t<a;t++){if(e[t].wildcard==="anySubPath"){u++}}if(u){if(u>1){console.log("Warning: multiple 'anySubPath' wildcards in the same pattern are not supported ATM");return false}p=r.length-e.length+1;if(p<0){return false}}else if(r.length!==e.length){return false}for(t=0,n=0,a=e.length;t<a;t++,n++){if(r[n]){l=n;if(r[n].type==="collection"&&e[t].wildcard!=="anySubPath"){s=n}}switch(e[t].wildcard){case"any":break;case"anySubPath":if(n>0){c.path={type:r[n-1].type,value:"/"+r.slice(0,n).map(o).join("/"),node:r[n-1].node};c.collectionPath={type:r[s].type,value:"/"+r.slice(0,s+1).map(o).join("/"),node:r[s].node}}else{c.path={type:null,value:"/",node:null};c.collectionPath=null}if(n<r.length){c.path.selectedChild={type:r[n].type,node:r[n].node}}if(p){c.subPath={type:r[n+p-1].type,value:"/"+r.slice(n,n+p).map(o).join("/"),node:r[n+p-1].node}}f=n+p;n+=p-1;break;case"anyId":if(r[n].type!=="id"){return false}break;case"anySlugId":if(r[n].type!=="slugId"){return false}break;case"anyDocument":if(r[n].type!=="id"&&r[n].type!=="slugId"){return false}break;case"anyCollection":if(r[n].type!=="collection"){return false}break;default:if(e[t].type!==r[n].type||e[t].identifier!==r[n].identifier){return false}}}if(!("path"in c)){c.path={type:r[l].type,value:"/"+r.map(o).join("/"),node:r[l].node}}if(f!==undefined&&f<r.length){c.endPath={type:r[l].type,value:"/"+r.slice(f).map(o).join("/"),node:r[l].node}}if(!("collectionPath"in c)){c.collectionPath={type:r[s].type,value:"/"+r.slice(0,s+1).map(o).join("/"),node:r[s].node}}return c};function o(e){return e.node}i.fullPathParse=function p(e,r){if(e&&typeof e==="object"){return e}var t,a={};t=e.match(/^(\/[^#?]*)(?:\?([^#?]+))?(?:#([^#?]+))?$/);if(!t){throw new Error("[restQuery] .fullPathParse() 'fullPath' should be a valid path")}a.path=i.parse(t[1],r);if(t[2]){a.query=t[2]}if(t[3]){a.fragment=t[3]}return a};i.fullPathMatch=function f(e,r){var t;try{if(!e||typeof e!=="object"){e=i.fullPathParse(e,true)}if(!r||r!=="object"){r=i.fullPathParse(r)}}catch(a){return false}if((e.fragment||null)!==(r.fragment||null)){return false}t=i.match(e.path,r.path);if(!t){return false}if(r.fragment){t.fragment=r.fragment}return t}},{"./charmap.js":2,"string-kit/lib/camel.js":4}],4:[function(e,r,t){"use strict";var a={};r.exports=a;a.toCamelCase=function n(e){if(!e||typeof e!=="string"){return""}return e.replace(/^[\s_-]*([^\s_-]+)|[\s_-]+([^\s_-]?)([^\s_-]*)/g,function(e,r,t,a){if(r){return r.toLowerCase()}if(!t){return""}return t.toUpperCase()+a.toLowerCase()})};a.camelCaseToDashed=function i(e){if(!e||typeof e!=="string"){return""}return e.replace(/^([A-Z])|([A-Z])/g,function(e,r,t){if(r){return r.toLowerCase()}return"-"+t.toLowerCase()})}},{}]},{},[1])(1)});